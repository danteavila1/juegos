let games = {
    data:[
    {
        id: 1,
        gameName: "Half-Life 2",
        category: "FPS",
        image:"/img/cards/hl2.jpg",
    },
    {
        id: 2,
        gameName: "Battlefield 1",
        category: "FPS",
        image:"/img/cards/bf1.jpg",
    },
    {
        id: 3,
        gameName: "Helldivers 2",
        category: "COOP",
        image:"/img/cards/helldivers.jpeg",
    },
    {
        id: 4,
        gameName: "Team Fortress 2",
        category: "FPS",
        image:"/img/cards/tf2.jpg",
    },
    {
        id: 5,
        gameName: "World of warcraft",
        category: "MMORPG",
        image:"/img/cards/wow.jpg",
    },
    {
        id: 6,
        gameName: "Genshin Impact",
        category: "RPG",
        image:"/img/cards/genshin.jpg",
    },
    {
        id: 7,
        gameName: "diablo 3",
        category: "RPG",
        image:"/img/cards/diablo3.jpg",
    },
    {
        id: 7,
        gameName: "Grim Dawn",
        category: "RPG",
        image:"/img/cards/grim_dawn.jpg",
    },
    {
        id: 8,
        gameName: "Lost Ark",
        category: "RPG",
        image:"/img/cards/lostArk.jpg",
    },
    {
        id: 9,
        gameName: "Path Of Exile",
        category: "RPG",
        image:"/img/cards/PathOfExile.jpg",
    },
    {
        id: 10,
        gameName: "Horizon Zero Dawn",
        category: "RPG",
        image:"/img/cards/horizon.jpg",
    },
    {
        id: 11,
        gameName: "Final Fantasy 7 Rebirth",
        category: "RPG",
        image:"/img/cards/ffv.jpg",
    },
    {
        id: 12,
        gameName: "Stardew Valley",
        category: "RPG",
        image:"/img/cards/stardew.jpg",
    },
    {
        id: 13,
        gameName: "Elden Ring",
        category: "RPG",
        image:"/img/cards/eldenRing.jpg",
    },
    {
        id: 14,
        gameName: "Black Desert",
        category: "MMORPG",
        image:"/img/cards/blackDesert.jpg",
    },
    {
        id: 15,
        gameName: "Guild Wars 2",
        category: "MMORPG",
        image:"/img/cards/guildWars2.jpg",
    },
    {
        id: 16,
        gameName: "Destiny 2",
        category: "MMORPG",
        image:"/img/cards/destiny2.jpg",
    },
    {
        id: 17,
        gameName: "The Elder Scrolls ONLINE",
        category: "MMORPG",
        image:"/img/cards/theElderScrolls.jpg",
    },
    {
        id: 18,
        gameName: "Albion Online",
        category: "MMORPG",
        image:"/img/cards/albionOnline.jpg",
    },
    {
        id: 19,
        gameName: "New World",
        category: "MMORPG",
        image:"/img/cards/newWorld.jpg",
    },
    {
        id: 20,
        gameName: "Sword Art Online: Fatal Bullet",
        category: "MMORPG",
        image:"/img/cards/sao.jpg",
    },
    {
        id: 21,
        gameName: "League Of Legends",
        category: "MOBA",
        image:"/img/cards/lol.jpg",
    },
    {
        id: 22,
        gameName: "Dota 2",
        category: "MOBA",
        image:"/img/cards/dota2.jpg",
    },
    {
        id: 23,
        gameName: "Smite",
        category: "MOBA",
        image:"/img/cards/smite.jpg",
    },
    {
        id: 24,
        gameName: "Heroes Of The Storm",
        category: "MOBA",
        image:"/img/cards/heroesOfStorm.jpg",
    },
    {
        id: 25,
        gameName: "Pokemon Unite",
        category: "MOBA",
        image:"/img/cards/pokemonUnite.jpg",
    },
    {
        id: 26,
        gameName: "Vainglory",
        category: "MOBA",
        image:"/img/cards/vainglory.jpg",
    },
    {
        id: 27,
        gameName: "Apex Legends",
        category: "FPS",
        image:"/img/cards/apex.jpg",
    },
    {
        id: 28,
        gameName: "Call Of Duty Warzone",
        category: "FPS",
        image:"/img/cards/cod.jpg",
    },
    {
        id: 29,
        gameName: "Battlefield 5",
        category: "FPS",
        image:"/img/cards/bf5.jpg",
    },
    {
        id: 30,
        gameName: "Doom Eternal",
        category: "FPS",
        image:"/img/cards/doomEternal.jpg",
    },
    {
        id: 31,
        gameName: "Titanfall 2",
        category: "FPS",
        image:"/img/cards/titanfall2.jpg",
    },
    {
        id: 32,
        gameName: "Valorant",
        category: "FPS",
        image:"/img/cards/valorant.jpg",
    },
    {
        id: 33,
        gameName: "Left 4 Dead 2",
        category: "FPS",
        image:"/img/cards/l4d2.jpg",
    },
    {
        id: 34,
        gameName: "Don't Starve Together",
        category: "SURVIVAL",
        image:"/img/cards/dontStarve.jpg",
    },
    {
        id: 35,
        gameName: "Rust",
        category: "SURVIVAL",
        image:"/img/cards/rust.jpg",
    },
    {
        id: 36,
        gameName: "Minecraft",
        category: "SURVIVAL",
        image:"/img/cards/minecraft.jpg",
    },
    {
        id: 37,
        gameName: "No Man's Sky",
        category: "SURVIVAL",
        image:"/img/cards/nomanssky.jpg",
    },
    {
        id: 38,
        gameName: "Ark: Survival Evolved",
        category: "SURVIVAL",
        image:"/img/cards/arkSurvivalEvolved.jpg",
    },
    {
        id: 39,
        gameName: "Subnautica",
        category: "SURVIVAL",
        image:"/img/cards/subnautica.jpg",
    },
    {
        id: 40,
        gameName: "Raft",
        category: "SURVIVAL",
        image:"/img/cards/raft.jpg",
    },
    {
        id: 41,
        gameName: "Project Zomboid",
        category: "SURVIVAL",
        image:"/img/cards/projectZomboid.jpg",
    },
    {
        id: 42,
        gameName: "Terraria",
        category: "SURVIVAL",
        image:"/img/cards/terraria.jpg",
    },
    {
        id: 43,
        gameName: "It Takes Two",
        category: "COOP",
        image:"/img/cards/itTakesTwo.jpg",
    },
    {
        id: 44,
        gameName: "We Were Here",
        category: "COOP",
        image:"/img/cards/weWereHere.jpg",
    },
    {
        id: 45,
        gameName: "Portal 2",
        category: "COOP",
        image:"/img/cards/portal2.jpg",
    },
    {
        id: 46,
        gameName: "Palworld",
        category: "COOP",
        image:"/img/cards/Palworld.jpg",
    },
    {
        id: 47,
        gameName: "Letal Company",
        category: "COOP",
        image:"/img/cards/lethalCompany.jpg",
    },
    {
        id: 48,
        gameName: "seaOfThieves",
        category: "COOP",
        image:"/img/cards/seaOfThieves.jpg",
    },
    {
        id: 49,
        gameName: "Monster Hunter Rise",
        category: "COOP",
        image:"/img/cards/monsterHunterRise.jpg",
    },
    {
        id: 50,
        gameName: "Overcooked! 2",
        category: "COOP",
        image:"/img/cards/overcooked2.jpg",
    }
]
};

function loadExploreGames(){
    for (let game of games.data){
        let card = document.createElement('div');
        card.classList.add('card', game.category);
        let imgContainer = document.createElement('div');
        imgContainer.classList.add("imageContainer");
        let image = document.createElement('img');
        image.setAttribute("src", game.image);
        imgContainer.appendChild(image);
        card.appendChild(imgContainer);

        let gamesContainer = document.getElementById('gamesContainer');
        
        let nameContainer = document.createElement('div');
        nameContainer.classList.add('nameContainer');

        let nameSubContainer = document.createElement('div');

        let name = document.createElement('h5');
        name.classList.add('gameName');
        name.innerText = game.gameName.toUpperCase();
        nameSubContainer.appendChild(name);
        let category = document.createElement("h6");
        category.innerText = game.category;

        let addBtn = document.createElement('button');
        addBtn.classList.add('addBtn');
        addBtn.innerText = "+";
        addBtn.onclick = () => {
            addGame(game.id);
            addBtnEffect(addBtn);
        };

        nameSubContainer.appendChild(category);
        nameContainer.appendChild(nameSubContainer);
        nameContainer.appendChild(addBtn);

        card.appendChild(nameContainer);
        gamesContainer.appendChild(card);
    }
}

function addBtnEffect(button) {
    // Remove the effect from all buttons first
    let buttons = document.querySelectorAll('.addBtn');
    buttons.forEach(btn => btn.classList.remove('hoverEffect'));

    // Add the effect to the clicked button
    button.classList.add('hoverEffect');

     // Remove the hover effect after a delay (e.g., 0.3 seconds)
     setTimeout(() => {
        button.classList.remove('hoverEffect');
    }, 200);
}


let selectedCategories = [];

function toggleCategory(value) {
    if (value === "all") {
        selectedCategories = ["all"];
    } else {
        const index = selectedCategories.indexOf(value);
        if (index > -1) {
            selectedCategories.splice(index, 1);
        } else {
            selectedCategories.push(value);
            selectedCategories = selectedCategories.filter(cat => cat !== "all");
        }
    }
    updateActiveButtons();
    filterGames();
}

function updateActiveButtons() {
    let buttons = document.querySelectorAll(".buttonValue");
    buttons.forEach(button => {
        if (selectedCategories.includes(button.innerText.toLowerCase())) {
            button.classList.add("active");
        } else {
            button.classList.remove("active");
        }
    });
}



function filterGames() {
    let elements = document.querySelectorAll(".card");
    let noGamesContainer = document.querySelector('.noGamesContainer');

    // Remove any existing noGamesContainer
    if (noGamesContainer) {
        noGamesContainer.remove();
    }

    let noGames = true;

    elements.forEach(element => {
        if (selectedCategories.includes("all")) {
            element.classList.remove("hide");
            noGames = false;
        } else {
            let show = false;
            for (let category of selectedCategories) {
                if (element.classList.contains(category.toUpperCase())) {
                    show = true;
                    break;
                }
            }
            if (show) {
                element.classList.remove("hide");
                noGames = false;
            } else {
                element.classList.add("hide");
            }
        }
    });

    if (noGames) {
        noGamesMessage();
    }
}

function noGamesMessage() {
    let gamesContainer = document.getElementById('gamesContainer');
    let imgContainer = document.createElement('div');
    imgContainer.classList.add("noGamesContainer");
    let image = document.createElement('img');
    image.setAttribute("src", '/img/nog2.png');
    imgContainer.appendChild(image);

    gamesContainer.appendChild(imgContainer);
}



















// //parameter passed from button
// function filterGame(value){
//     let buttons = document.querySelectorAll(".buttonValue");
//     buttons.forEach(button => {
//         //check if value equals innetText
//         if(value.toUpperCase() == button.innerText.toUpperCase()){
//             button.classList.add("active");
//         }
//         else{
//             button.classList.remove("active");
//         }
//     })

//     //select all cards
//     let elements = document.querySelectorAll(".card");
//     //loop through all cards
//     elements.forEach(element => {
//         //display all cards on 'all' btn click
//         if(value == "all"){
//             element.classList.remove("hide");
//         } else{
//             //check if element contains category
//             if(element.classList.contains(value.toUpperCase())){
//                 //display element based on category
//                 element.classList.remove("hide");
//             }
//             else{
//                 //hide the others elements
//                 element.classList.add("hide");
//             }
//         }
//     });
// }


//seach btn
document.getElementById('search').addEventListener("click", () => {
    let searchInput = document.getElementById('searchInput').value;
    let elements = document.querySelectorAll(".gameName");
    let cards = document.querySelectorAll(".card");
    let noGamesContainer = document.querySelector('.noGamesContainer');

    // Remove any existing noGamesContainer
    if (noGamesContainer) {
        noGamesContainer.remove();
    }
    //loop through all elements
    elements.forEach((element, index) =>{
        if(element.innerText.includes(searchInput.toUpperCase())){
            cards[index].classList.remove("hide");
        }
        else{
            cards[index].classList.add("hide");
        }
    })

});

function addGame (id){
    console.log(id);
    for (let game of games.data) {
        if (id == game.id) {
            // Retrieve the current list of games from local storage
                let selectedGames = JSON.parse(localStorage.getItem('selectedGames')) || [];
                
                // Check if the game is already in the list to avoid duplicates
                let gameExists = selectedGames.some(g => g.id === game.id);
                if (!gameExists) {
                    // Add the new game to the list
                    selectedGames.push(game);
                    
                    // Save the updated list back to local storage
                    localStorage.setItem('selectedGames', JSON.stringify(selectedGames));
                    console.log('Game added to local storage:', game);
                } else {
                    console.log('Game already exists in local storage:', game);
                }
            
                break;
        }
    }
}



loadExploreGames();

//all filter by default

window.onload = () => {
    filterGame("all");
};

